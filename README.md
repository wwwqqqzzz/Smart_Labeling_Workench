# 智能打标便捷器 - 文档导航

## 📚 文档结构

```
Smart Labeling Workbench/
├── README.md                  # 本文档（文档导航）
├── prompts/                   # 角色定义 Prompt
│   └── 01-roles.md           # 8 个开发角色及其 Prompt
└── docs/                      # 项目文档
    ├── 01-项目概述.md         # 项目背景、目标、解决方案
    ├── 02-技术架构设计.md     # 系统架构、数据模型、API 设计
    ├── 03-数据流程与RAG实现.md # 数据流程、RAG 引擎实现
    ├── 04-实施计划.md         # 6 周开发计划、里程碑
    ├── 05-功能测试报告.md     # 功能测试结果、性能数据
    ├── 06-用户使用手册.md     # 用户操作指南、快捷键说明
    ├── 07-开发者文档.md       # 技术实现细节、API文档
    ├── 08-部署指南.md         # Docker部署、生产环境配置
    ├── 09-批次管理功能开发报告.md # Excel批次管理功能实现（后端）
    └── 10-批次管理前端实现报告.md # Excel批次管理功能实现（前端）
```

---

## 📖 快速导航

### 1. 角色定义 Prompt
**文件**: [prompts/01-roles.md](prompts/01-roles.md)

定义了项目开发过程中 AI 需要扮演的 8 个角色：

1. **产品经理** - 挖掘需求、定义 MVP、判断优先级
2. **UI/UX 设计师** - 界面设计、交互细节、快捷键
3. **系统架构师** - 技术选型、架构设计、避免过度设计
4. **后端开发工程师** - FastAPI、RAG 引擎、API 开发
5. **前端开发工程师** - Next.js、React、shadcn/ui
6. **测试工程师** - pytest、准确性测试、覆盖率
7. **DevOps 工程师** - Docker、部署、监控
8. **技术文档撰写者** - API 文档、用户手册

**使用方式**：
在开发不同阶段时，加载对应的角色 Prompt，让 AI 按照角色定位提供专业建议。

### 2. 项目概述
**文件**: [docs/01-项目概述.md](docs/01-项目概述.md)

包含内容：
- **项目背景**：当前痛点、数据现状
- **项目目标**：效率提升 5-10 倍、保持准确率
- **解决方案**：对话还原、智能推荐、快速操作
- **技术架构**：前后端分离、RAG 引擎
- **功能优先级**：P0/P1/P2 分阶段实现
- **实施计划**：6 周开发周期
- **预期收益**：时间节省 75-80%

**适合人群**：项目管理者、产品经理、新加入团队的成员

### 3. 技术架构设计
**文件**: [docs/02-技术架构设计.md](docs/02-技术架构设计.md)

包含内容：
- **系统架构**：分层架构（表现层、应用层、数据层）
- **数据模型**：ER 图、表结构设计（conversations、tags、audit_logs）
- **RAG 引擎**：工作流程、代码结构、关键模块
- **API 设计**：RESTful 规范、端点列表、请求/响应示例
- **安全性**：数据安全、输入验证、性能优化

**适合人群**：系统架构师、后端开发工程师、前端开发工程师

### 4. 数据流程与 RAG 实现
**文件**: [docs/03-数据流程与RAG实现.md](docs/03-数据流程与RAG实现.md)

包含内容：
- **数据导入流程**：Excel → SQLite → Chroma
- **审核工作流程**：用户操作 → RAG 推荐 → 保存结果
- **向量库构建**：标签定义向量化、Chroma 集成
- **向量检索**：混合检索（向量 + BM25）
- **LLM 判断**：Prompt 工程、GLM-4 调用
- **前端数据流**：React Query、Zustand 状态管理

**适合人群**：AI 工程师、RAG 开发者、数据工程师

### 5. 实施计划
**文件**: [docs/04-实施计划.md](docs/04-实施计划.md)

包含内容：
- **总体时间表**：6 周开发周期、每周目标
- **详细任务清单**：每周的具体任务、验收标准
- **里程碑**：6 个关键里程碑、交付物
- **成功指标**：效率、质量、性能指标
- **风险管理**：技术风险、进度风险、应对措施

**适合人群**：项目经理、开发团队、所有参与者

### 6. 功能测试报告
**文件**: [docs/05-功能测试报告.md](docs/05-功能测试报告.md)

包含内容：
- **测试概览**: 测试范围、测试数据、测试环境
- **API测试**: 6个核心接口测试结果
- **功能验证**: 数据库索引、CORS配置、疑难案例标记
- **性能测试**: API响应时间、数据库查询性能
- **测试结论**: 验收标准、下一步行动

**适合人群**: 测试工程师、项目经理、所有开发人员

### 7. 用户使用手册
**文件**: [docs/06-用户使用手册.md](docs/06-用户使用手册.md)

包含内容：
- **系统简介**: 核心功能、效率提升
- **快速开始**: 访问系统、界面布局、基本流程
- **界面说明**: 对话展示区、操作区、快捷键
- **功能详解**: AI推荐、标签搜索、标签分类、疑难案例标记
- **最佳实践**: 审核技巧、标签选择原则、速度优化建议

**适合人群**: 审核人员、最终用户、新用户培训

### 8. 开发者文档
**文件**: [docs/07-开发者文档.md](docs/07-开发者文档.md)

包含内容：
- **系统架构**: 整体架构图、技术栈
- **环境搭建**: 前置要求、后端环境、前端环境、Docker部署
- **项目结构**: 完整目录结构、文件说明
- **数据库设计**: ER图、表结构、索引
- **API文档**: 接口列表、请求响应示例
- **RAG推荐引擎**: 架构设计、核心代码实现
- **前端组件**: 核心组件说明、自定义Hooks
- **开发规范**: 代码风格、Git提交规范、测试规范

**适合人群**: 后端开发、前端开发、全栈开发

### 9. 部署指南
**文件**: [docs/08-部署指南.md](docs/08-部署指南.md)

包含内容：
- **部署架构**: 生产环境架构图、资源要求
- **开发环境部署**: Docker Compose、本地开发
- **生产环境部署**: 小型部署（Docker Compose）、大型部署（Kubernetes）
- **Docker优化**: 多阶段构建、镜像优化、Docker Compose优化
- **监控与日志**: 日志管理、监控指标、Prometheus集成
- **备份策略**: 数据库备份、向量数据库备份、恢复流程
- **故障排查**: 常见问题及解决方案
- **性能优化**: 数据库优化、应用优化

**适合人群**: DevOps工程师、运维人员、系统管理员

---

## 🚀 快速开始

### 第一次阅读

如果你是第一次接触这个项目，建议按以下顺序阅读：

1. **[项目概述](docs/01-项目概述.md)** - 了解项目背景和目标
2. **[技术架构设计](docs/02-技术架构设计.md)** - 理解系统架构
3. **[实施计划](docs/04-实施计划.md)** - 了解开发计划

### 开发阶段

如果你要开始开发，建议参考：

1. **[角色定义 Prompt](prompts/01-roles.md)** - 选择对应角色
2. **[数据流程与 RAG 实现](docs/03-数据流程与RAG实现.md)** - 技术实现细节
3. **[实施计划](docs/04-实施计划.md)** - 具体任务清单

### 生产环境快速部署（5分钟）

如果你要快速部署到生产环境：

1. **[QUICK_START.md](QUICK_START.md)** - 5分钟快速部署指南
2. **[DEPLOYMENT.md](DEPLOYMENT.md)** - 完整生产环境部署文档
3. **[deploy.sh](deploy.sh)** - 一键部署脚本

**部署命令**：
```bash
# 1. 配置环境变量
cp .env.production.example .env.production
vim .env.production  # 填入GLM_API_KEY等配置

# 2. 一键部署
chmod +x deploy.sh
./deploy.sh
```


### 运维部署

如果你要部署系统，建议参考：

1. **[部署指南](docs/08-部署指南.md)** - Docker部署、生产环境配置、监控备份
2. **[开发者文档](docs/07-开发者文档.md)** - 环境搭建、项目结构
3. **[技术架构设计](docs/02-技术架构设计.md)** - API 接口、安全性

---

## 🎯 核心概念

### RAG 是什么？

**RAG（Retrieval-Augmented Generation）** = 检索增强生成

在我们的项目中：
1. **检索**：在 56 个标签定义中检索与对话最相关的标签
2. **增强**：将检索到的标签定义提供给 LLM
3. **生成**：LLM 根据对话内容和标签定义，判断 AI 标签是否正确

**为什么需要 RAG？**
- AI 标签可能错误，需要人工审核
- 人工审核效率低，需要智能辅助
- RAG 可以理解对话语义，提供准确推荐

### 标签分类体系

56 个标签分为 6 大类：

- **车型类**（14个）：面包车、高栏、厢货、平板、尾板车等
- **费用类**（7个）：高速费、进出场费、装卸费、等待费等
- **装卸类**（6个）：装卸费、搬运装卸、搭把手、不搬运等
- **车门类**（8个）：侧门单开、侧门双开、侧门全开等
- **尺寸类**（5个）：车厢长X米、车宽X米、车容量X方等
- **其他**（16个）：跟车X人、拼车单、雨布、绳子等

### 关键技术栈

| 层级 | 技术 | 用途 |
|------|------|------|
| 前端 | Next.js 15 + shadcn/ui | 对话展示、标签操作 |
| 后端 | FastAPI + SQLAlchemy | API 服务、数据存储 |
| AI | GLM-4 Flash + LangChain | 标签判断、推理生成 |
| 向量库 | Chroma | 标签定义向量索引 |
| 嵌入 | OpenAI text-embedding-3-small | 文本向量化 |
| 数据库 | SQLite | 对话、标签、审核记录 |
| 缓存 | Redis | RAG 结果缓存 |

---

## 📊 项目数据

### 数据规模
- **对话数量**：3,500 条（生产环境）
- **标签数量**：23 个标准化标签
- **平均长度**：556 字符/条
- **已审核**：100%（01 期）

### 标签分布（测试数据）
- **车辆类型**: 8个（尾板车、冷链车、半挂车等）
- **货物类型**: 5个（钢材、水果、建材、粮食等）
- **运输类型**: 3个（快递、短途、长途）
- **特殊运输**: 4个（危险品、大件、气垫车等）
- **冷链运输**: 2个（冷冻食品、药品）

### 性能指标（实测）
- **API响应时间**: 20-500ms（P95）
- **数据库查询**: < 50ms
- **RAG推荐速度**: < 500ms
- **目标审核速度**: 20-30秒/条

### 效率提升
- **传统方式**: 3-5分钟/条，3500条需要20-30小时
- **使用本系统**: 20-30秒/条，预计总时间4-6小时
- **效率提升**: **5-10倍**

---

## 🔗 相关资源

### 技术文档
- [Next.js 文档](https://nextjs.org/docs)
- [FastAPI 文档](https://fastapi.tiangolo.com/)
- [LangChain 文档](https://python.langchain.com/)
- [Chroma 文档](https://docs.trychroma.com/)
- [GLM-4 API 文档](https://open.bigmodel.cn/dev/api)

### 开发工具
- [shadcn/ui](https://ui.shadcn.com/) - UI 组件库
- [Tailwind CSS](https://tailwindcss.com/) - CSS 框架
- [Zustand](https://zustand-demo.pmnd.rs/) - 状态管理
- [React Query](https://tanstack.com/query/latest) - 服务端状态

### 学习资源
- [RAG 教程](https://www.anthropic.com/index/building-claude-with-retrieval-augmented-generation)
- [向量数据库指南](https://www.pinecone.io/learn/)
- [Prompt 工程](https://www.promptingguide.ai/)

---

## 🤝 贡献指南

### 开发流程

1. **选择角色**：从 [prompts/01-roles.md](prompts/01-roles.md) 选择对应角色
2. **阅读文档**：根据开发阶段阅读相关文档
3. **执行任务**：按照 [实施计划](docs/04-实施计划.md) 执行
4. **提交代码**：遵循代码规范，编写测试

### 代码规范

**后端**：
- 遵循 PEP 8
- 使用类型提示（Type Hints）
- 函数 < 50 行
- 编写文档字符串

**前端**：
- 使用 TypeScript 严格模式
- 组件 < 300 行
- 遵循 React Hooks 规范
- 使用 shadcn/ui 组件

### 测试要求

- 后端：pytest，覆盖率 > 80%
- 前端：Jest + Testing Library
- RAG：准确性测试 > 85%

---

## 📞 联系方式

**项目名称**: 智能打标便捷器 (Smart Labeling Workbench)
**技术栈**: Next.js + FastAPI + GLM-4 + Chroma
**开发周期**: 6 周（2025-01-13 ~ 2025-02-23）
**最后更新**: 2025-01-13

---

## 📝 更新日志

### v0.1.0 (2026-01-13) - 第6周完成 ✅

**开发进度**: 100% (6/6周完成)

**新增功能**:
- ✅ 完成第6周开发（测试与部署）
- ✅ 生成测试数据（50条对话）
- ✅ 完整功能测试（API、数据库、RAG）
- ✅ 编写用户使用手册（完整操作指南）
- ✅ 编写开发者文档（技术实现细节）
- ✅ 编写部署指南（Docker、Kubernetes）

**系统功能**:
- ✅ 对话审核流程完整可用
- ✅ AI智能推荐（RAG引擎）
- ✅ 快捷键支持（空格、Enter、数字键、R键）
- ✅ 疑难案例标记
- ✅ 标签定义提示
- ✅ 性能统计（速度、预计时间）
- ✅ 数据库索引优化

**技术改进**:
- ✅ 修复CORS配置问题
- ✅ 修复数据库表结构同步问题
- ✅ 修复React Hooks顺序问题
- ✅ 优化Docker镜像构建
- ✅ 添加健康检查端点

**文档完善**:
- ✅ 功能测试报告（95%覆盖率）
- ✅ 用户使用手册（完整操作指南）
- ✅ 开发者文档（API文档、架构设计）
- ✅ 部署指南（Docker、Kubernetes）

---

### v0.0.1 (2025-01-13) - 项目初始化

- ✅ 完成角色 Prompt 定制
- ✅ 完成项目概述文档
- ✅ 完成技术架构设计文档
- ✅ 完成数据流程与 RAG 实现文档
- ✅ 完成实施计划文档
- ✅ 创建文档导航（本文件）

---

**项目状态**: 🟢 **生产就绪**

**可以开始使用或部署到生产环境！** 🎉

**祝开发顺利！🚀**
